{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Tilwani's/Desktop/The-Dilemma/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Tilwani's/Desktop/The-Dilemma/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Tilwani's/Desktop/The-Dilemma/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useContext,useState}from\"react\";import{toast}from\"react-hot-toast\";import{useLocation,useNavigate}from\"react-router-dom\";import{loginService,signupService}from\"../services/authServices\";import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext();export var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var navigate=useNavigate();var location=useLocation();var localStorageToken=JSON.parse(localStorage.getItem(\"loginDetails\"));var _useState=useState((localStorageToken===null||localStorageToken===void 0?void 0:localStorageToken.token)||\"\"),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(localStorageToken===null||localStorageToken===void 0?void 0:localStorageToken.user),_useState4=_slicedToArray(_useState3,2),currentUser=_useState4[0],setCurrentUser=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setIsLoading=_useState6[1];var loginHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref2){var username,password,response,status,_response$data,encodedToken,foundUser,_location$state,_location$state$from;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:username=_ref2.username,password=_ref2.password;setIsLoading(true);_context.prev=2;_context.next=5;return loginService(username,password);case 5:response=_context.sent;status=response.status,_response$data=response.data,encodedToken=_response$data.encodedToken,foundUser=_response$data.foundUser;if(status===200){localStorage.setItem(\"loginDetails\",JSON.stringify({token:encodedToken,user:foundUser}));setToken(encodedToken);setCurrentUser(foundUser);toast.success(\"Welcome back, \".concat(foundUser.firstName,\"!\"),{icon:\"ðŸ‘‹\"});navigate((location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||\"/\",{replace:true});}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);console.error(_context.t0);toast.error(\"Please enter correct details.\");case 14:_context.prev=14;setIsLoading(false);return _context.finish(14);case 17:case\"end\":return _context.stop();}},_callee,null,[[2,10,14,17]]);}));return function loginHandler(_x){return _ref3.apply(this,arguments);};}();var signupHandler=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref4){var firstName,lastName,username,password,response,status,_response$data2,createdUser,encodedToken;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:firstName=_ref4.firstName,lastName=_ref4.lastName,username=_ref4.username,password=_ref4.password;setIsLoading(true);_context2.prev=2;_context2.next=5;return signupService(firstName,lastName,username,password);case 5:response=_context2.sent;status=response.status,_response$data2=response.data,createdUser=_response$data2.createdUser,encodedToken=_response$data2.encodedToken;if(status===201){localStorage.setItem(\"loginDetails\",JSON.stringify({token:encodedToken,user:createdUser}));setToken(encodedToken);setCurrentUser(createdUser);toast.success(\"Hi, \".concat(createdUser.firstName,\"!\"),{icon:\"ðŸ‘‹\"});navigate(\"/\",{replace:true});}_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);console.error(_context2.t0);toast.error(\"Something went wrong! Please try again.\");case 14:_context2.prev=14;setIsLoading(false);return _context2.finish(14);case 17:case\"end\":return _context2.stop();}},_callee2,null,[[2,10,14,17]]);}));return function signupHandler(_x2){return _ref5.apply(this,arguments);};}();var logoutHandler=function logoutHandler(){localStorage.removeItem(\"loginDetails\");setToken(null);setCurrentUser(null);toast.success(\"Logged out successfully!\");navigate(\"/auth/login\");};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{token:token,currentUser:currentUser,setCurrentUser:setCurrentUser,loginHandler:loginHandler,loading:loading,logoutHandler:logoutHandler,signupHandler:signupHandler},children:children});};export var useAuth=function useAuth(){return useContext(AuthContext);};","map":{"version":3,"names":["createContext","useContext","useState","toast","useLocation","useNavigate","loginService","signupService","jsx","_jsx","AuthContext","AuthProvider","_ref","children","navigate","location","localStorageToken","JSON","parse","localStorage","getItem","_useState","token","_useState2","_slicedToArray","setToken","_useState3","user","_useState4","currentUser","setCurrentUser","_useState5","_useState6","loading","setIsLoading","loginHandler","_ref3","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref2","username","password","response","status","_response$data","encodedToken","foundUser","_location$state","_location$state$from","wrap","_callee$","_context","prev","next","sent","data","setItem","stringify","success","concat","firstName","icon","state","from","pathname","replace","t0","console","error","finish","stop","_x","apply","arguments","signupHandler","_ref5","_callee2","_ref4","lastName","_response$data2","createdUser","_callee2$","_context2","_x2","logoutHandler","removeItem","Provider","value","useAuth"],"sources":["C:/Users/Tilwani's/Desktop/The-Dilemma/src/contexts/auth-context.js"],"sourcesContent":["import { createContext, useContext, useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loginService, signupService } from \"../services/authServices\";\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const localStorageToken = JSON.parse(localStorage.getItem(\"loginDetails\"));\n\n  const [token, setToken] = useState(localStorageToken?.token || \"\");\n  const [currentUser, setCurrentUser] = useState(localStorageToken?.user);\n  const [loading, setIsLoading] = useState(false);\n\n  const loginHandler = async ({ username, password }) => {\n    setIsLoading(true);\n    try {\n      const response = await loginService(username, password);\n      const {\n        status,\n        data: { encodedToken, foundUser },\n      } = response;\n      if (status === 200) {\n        localStorage.setItem(\n          \"loginDetails\",\n          JSON.stringify({ token: encodedToken, user: foundUser })\n        );\n        setToken(encodedToken);\n        setCurrentUser(foundUser);\n        toast.success(`Welcome back, ${foundUser.firstName}!`, { icon: \"ðŸ‘‹\" });\n        navigate(location?.state?.from?.pathname || \"/\", { replace: true });\n      }\n    } catch (error) {\n      console.error(error);\n      toast.error(\"Please enter correct details.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signupHandler = async ({ firstName, lastName, username, password }) => {\n    setIsLoading(true);\n    try {\n      const response = await signupService(\n        firstName,\n        lastName,\n        username,\n        password\n      );\n      const {\n        status,\n        data: { createdUser, encodedToken },\n      } = response;\n      if (status === 201) {\n        localStorage.setItem(\n          \"loginDetails\",\n          JSON.stringify({ token: encodedToken, user: createdUser })\n        );\n        setToken(encodedToken);\n        setCurrentUser(createdUser);\n        toast.success(`Hi, ${createdUser.firstName}!`, {\n          icon: \"ðŸ‘‹\",\n        });\n        navigate(\"/\", { replace: true });\n      }\n    } catch (error) {\n      console.error(error);\n      toast.error(\"Something went wrong! Please try again.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const logoutHandler = () => {\n    localStorage.removeItem(\"loginDetails\");\n    setToken(null);\n    setCurrentUser(null);\n    toast.success(\"Logged out successfully!\");\n    navigate(\"/auth/login\");\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        token,\n        currentUser,\n        setCurrentUser,\n        loginHandler,\n        loading,\n        logoutHandler,\n        signupHandler,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n"],"mappings":"oYAAA,OAASA,aAAa,CAAEC,UAAU,CAAEC,QAAQ,KAAQ,OAAO,CAC3D,OAASC,KAAK,KAAQ,iBAAiB,CACvC,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,OAASC,YAAY,CAAEC,aAAa,KAAQ,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvE,MAAO,IAAM,CAAAC,WAAW,cAAGV,aAAa,CAAC,CAAC,CAE1C,MAAO,IAAM,CAAAW,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAAC,IAAA,CAAqB,IAAf,CAAAC,QAAQ,CAAAD,IAAA,CAARC,QAAQ,CACrC,GAAM,CAAAC,QAAQ,CAAGT,WAAW,CAAC,CAAC,CAC9B,GAAM,CAAAU,QAAQ,CAAGX,WAAW,CAAC,CAAC,CAE9B,GAAM,CAAAY,iBAAiB,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC,CAE1E,IAAAC,SAAA,CAA0BnB,QAAQ,CAAC,CAAAc,iBAAiB,SAAjBA,iBAAiB,iBAAjBA,iBAAiB,CAAEM,KAAK,GAAI,EAAE,CAAC,CAAAC,UAAA,CAAAC,cAAA,CAAAH,SAAA,IAA3DC,KAAK,CAAAC,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtB,IAAAG,UAAA,CAAsCxB,QAAQ,CAACc,iBAAiB,SAAjBA,iBAAiB,iBAAjBA,iBAAiB,CAAEW,IAAI,CAAC,CAAAC,UAAA,CAAAJ,cAAA,CAAAE,UAAA,IAAhEG,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAClC,IAAAG,UAAA,CAAgC7B,QAAQ,CAAC,KAAK,CAAC,CAAA8B,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAxCE,OAAO,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAE5B,GAAM,CAAAG,YAAY,6BAAAC,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAAC,KAAA,MAAAC,QAAA,CAAAC,QAAA,CAAAC,QAAA,CAAAC,MAAA,CAAAC,cAAA,CAAAC,YAAA,CAAAC,SAAA,CAAAC,eAAA,CAAAC,oBAAA,QAAAZ,mBAAA,GAAAa,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAASb,QAAQ,CAAAD,KAAA,CAARC,QAAQ,CAAEC,QAAQ,CAAAF,KAAA,CAARE,QAAQ,CAC9CT,YAAY,CAAC,IAAI,CAAC,CAACmB,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEM,CAAAjD,YAAY,CAACoC,QAAQ,CAAEC,QAAQ,CAAC,QAAjDC,QAAQ,CAAAS,QAAA,CAAAG,IAAA,CAEZX,MAAM,CAEJD,QAAQ,CAFVC,MAAM,CAAAC,cAAA,CAEJF,QAAQ,CADVa,IAAI,CAAIV,YAAY,CAAAD,cAAA,CAAZC,YAAY,CAAEC,SAAS,CAAAF,cAAA,CAATE,SAAS,CAEjC,GAAIH,MAAM,GAAK,GAAG,CAAE,CAClB1B,YAAY,CAACuC,OAAO,CAClB,cAAc,CACdzC,IAAI,CAAC0C,SAAS,CAAC,CAAErC,KAAK,CAAEyB,YAAY,CAAEpB,IAAI,CAAEqB,SAAU,CAAC,CACzD,CAAC,CACDvB,QAAQ,CAACsB,YAAY,CAAC,CACtBjB,cAAc,CAACkB,SAAS,CAAC,CACzB7C,KAAK,CAACyD,OAAO,kBAAAC,MAAA,CAAkBb,SAAS,CAACc,SAAS,MAAK,CAAEC,IAAI,CAAE,IAAK,CAAC,CAAC,CACtEjD,QAAQ,CAAC,CAAAC,QAAQ,SAARA,QAAQ,kBAAAkC,eAAA,CAARlC,QAAQ,CAAEiD,KAAK,UAAAf,eAAA,kBAAAC,oBAAA,CAAfD,eAAA,CAAiBgB,IAAI,UAAAf,oBAAA,iBAArBA,oBAAA,CAAuBgB,QAAQ,GAAI,GAAG,CAAE,CAAEC,OAAO,CAAE,IAAK,CAAC,CAAC,CACrE,CAACd,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAe,EAAA,CAAAf,QAAA,aAEDgB,OAAO,CAACC,KAAK,CAAAjB,QAAA,CAAAe,EAAM,CAAC,CACpBjE,KAAK,CAACmE,KAAK,CAAC,+BAA+B,CAAC,CAAC,QAAAjB,QAAA,CAAAC,IAAA,IAE7CpB,YAAY,CAAC,KAAK,CAAC,CAAC,OAAAmB,QAAA,CAAAkB,MAAA,8BAAAlB,QAAA,CAAAmB,IAAA,MAAAhC,OAAA,uBAEvB,kBAxBK,CAAAL,YAAYA,CAAAsC,EAAA,SAAArC,KAAA,CAAAsC,KAAA,MAAAC,SAAA,OAwBjB,CAED,GAAM,CAAAC,aAAa,6BAAAC,KAAA,CAAAxC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAuC,SAAAC,KAAA,MAAAjB,SAAA,CAAAkB,QAAA,CAAAtC,QAAA,CAAAC,QAAA,CAAAC,QAAA,CAAAC,MAAA,CAAAoC,eAAA,CAAAC,WAAA,CAAAnC,YAAA,QAAAT,mBAAA,GAAAa,IAAA,UAAAgC,UAAAC,SAAA,iBAAAA,SAAA,CAAA9B,IAAA,CAAA8B,SAAA,CAAA7B,IAAA,SAASO,SAAS,CAAAiB,KAAA,CAATjB,SAAS,CAAEkB,QAAQ,CAAAD,KAAA,CAARC,QAAQ,CAAEtC,QAAQ,CAAAqC,KAAA,CAARrC,QAAQ,CAAEC,QAAQ,CAAAoC,KAAA,CAARpC,QAAQ,CACpET,YAAY,CAAC,IAAI,CAAC,CAACkD,SAAA,CAAA9B,IAAA,GAAA8B,SAAA,CAAA7B,IAAA,SAEM,CAAAhD,aAAa,CAClCuD,SAAS,CACTkB,QAAQ,CACRtC,QAAQ,CACRC,QACF,CAAC,QALKC,QAAQ,CAAAwC,SAAA,CAAA5B,IAAA,CAOZX,MAAM,CAEJD,QAAQ,CAFVC,MAAM,CAAAoC,eAAA,CAEJrC,QAAQ,CADVa,IAAI,CAAIyB,WAAW,CAAAD,eAAA,CAAXC,WAAW,CAAEnC,YAAY,CAAAkC,eAAA,CAAZlC,YAAY,CAEnC,GAAIF,MAAM,GAAK,GAAG,CAAE,CAClB1B,YAAY,CAACuC,OAAO,CAClB,cAAc,CACdzC,IAAI,CAAC0C,SAAS,CAAC,CAAErC,KAAK,CAAEyB,YAAY,CAAEpB,IAAI,CAAEuD,WAAY,CAAC,CAC3D,CAAC,CACDzD,QAAQ,CAACsB,YAAY,CAAC,CACtBjB,cAAc,CAACoD,WAAW,CAAC,CAC3B/E,KAAK,CAACyD,OAAO,QAAAC,MAAA,CAAQqB,WAAW,CAACpB,SAAS,MAAK,CAC7CC,IAAI,CAAE,IACR,CAAC,CAAC,CACFjD,QAAQ,CAAC,GAAG,CAAE,CAAEqD,OAAO,CAAE,IAAK,CAAC,CAAC,CAClC,CAACiB,SAAA,CAAA7B,IAAA,kBAAA6B,SAAA,CAAA9B,IAAA,IAAA8B,SAAA,CAAAhB,EAAA,CAAAgB,SAAA,aAEDf,OAAO,CAACC,KAAK,CAAAc,SAAA,CAAAhB,EAAM,CAAC,CACpBjE,KAAK,CAACmE,KAAK,CAAC,yCAAyC,CAAC,CAAC,QAAAc,SAAA,CAAA9B,IAAA,IAEvDpB,YAAY,CAAC,KAAK,CAAC,CAAC,OAAAkD,SAAA,CAAAb,MAAA,8BAAAa,SAAA,CAAAZ,IAAA,MAAAM,QAAA,uBAEvB,kBA/BK,CAAAF,aAAaA,CAAAS,GAAA,SAAAR,KAAA,CAAAH,KAAA,MAAAC,SAAA,OA+BlB,CAED,GAAM,CAAAW,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAA,CAAS,CAC1BnE,YAAY,CAACoE,UAAU,CAAC,cAAc,CAAC,CACvC9D,QAAQ,CAAC,IAAI,CAAC,CACdK,cAAc,CAAC,IAAI,CAAC,CACpB3B,KAAK,CAACyD,OAAO,CAAC,0BAA0B,CAAC,CACzC9C,QAAQ,CAAC,aAAa,CAAC,CACzB,CAAC,CAED,mBACEL,IAAA,CAACC,WAAW,CAAC8E,QAAQ,EACnBC,KAAK,CAAE,CACLnE,KAAK,CAALA,KAAK,CACLO,WAAW,CAAXA,WAAW,CACXC,cAAc,CAAdA,cAAc,CACdK,YAAY,CAAZA,YAAY,CACZF,OAAO,CAAPA,OAAO,CACPqD,aAAa,CAAbA,aAAa,CACbV,aAAa,CAAbA,aACF,CAAE,CAAA/D,QAAA,CAEDA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED,MAAO,IAAM,CAAA6E,OAAO,CAAG,QAAV,CAAAA,OAAOA,CAAA,QAAS,CAAAzF,UAAU,CAACS,WAAW,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}