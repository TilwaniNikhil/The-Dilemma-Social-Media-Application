{"ast":null,"code":"import React,{useEffect,useRef}from\"react\";import{Loader,PostCard,SearchBar,SideBar,SuggestedUsers}from\"../../components\";import{usePosts}from\"../../index\";import{actionTypes}from\"../../utils/constants\";import{sortPosts}from\"../../utils/sortPosts\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Explore=function Explore(){var _usePosts=usePosts(),_usePosts$postsState=_usePosts.postsState,posts=_usePosts$postsState.posts,page=_usePosts$postsState.page,isNextPostLoading=_usePosts$postsState.isNextPostLoading,isLoading=_usePosts.isLoading,postsDispatch=_usePosts.postsDispatch;var elementRef=useRef(null);var SET_PAGE=actionTypes.SET_PAGE,SET_IS_NEXT_POST_LOADING=actionTypes.SET_IS_NEXT_POST_LOADING;var sortedPosts=sortPosts(posts,\"Latest\").slice(0,page*5);useEffect(function(){if(sortedPosts.length>0){var observer=new IntersectionObserver(function(entries){var entry=entries[0];if(entry.isIntersecting){postsDispatch({type:SET_IS_NEXT_POST_LOADING,payload:true});postsDispatch({type:SET_PAGE,payload:page+1});}});if(elementRef.current){observer.observe(elementRef.current);}}},[page,sortedPosts.length,SET_IS_NEXT_POST_LOADING,SET_PAGE,postsDispatch]);document.title=\"Explore\";useEffect(function(){var timeoutId;if(isNextPostLoading){timeoutId=setTimeout(function(){postsDispatch({type:SET_IS_NEXT_POST_LOADING,payload:false});},1000);}return function(){clearTimeout(timeoutId);};},[isNextPostLoading,sortedPosts,SET_IS_NEXT_POST_LOADING,postsDispatch]);useEffect(function(){window.scrollTo({top:0});postsDispatch({type:SET_PAGE,payload:1});},[postsDispatch,SET_PAGE]);return/*#__PURE__*/_jsxs(\"div\",{className:\"grid sm:grid-cols-[5rem_1fr] lg:grid-cols-[12rem_1fr] xl:grid-cols-[13rem_1fr_20rem] w-[100%] lg:w-[80%] mb-16 sm:m-auto dark:bg-darkColor dark:text-lightGrey transition-all duration-500\",children:[/*#__PURE__*/_jsx(SideBar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"sm:border-x border-darkGrey dark:border-lightGrey\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\" p-4 sticky top-0 backdrop-blur-md z-20 border-b border-darkGrey dark:border-lightGrey flex items-center justify-between gap-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold\",children:\"Explore\"}),/*#__PURE__*/_jsx(\"div\",{className:\"block xl:hidden\",children:/*#__PURE__*/_jsx(SearchBar,{})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:isLoading?/*#__PURE__*/_jsx(Loader,{}):(sortedPosts===null||sortedPosts===void 0?void 0:sortedPosts.length)>0?/*#__PURE__*/_jsxs(_Fragment,{children:[sortedPosts.map(function(post,index){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(PostCard,{post:post}),index===(sortedPosts===null||sortedPosts===void 0?void 0:sortedPosts.length)-1&&/*#__PURE__*/_jsx(\"div\",{ref:elementRef})]},post._id);}),!(sortedPosts!==null&&sortedPosts!==void 0&&sortedPosts.length)===(posts===null||posts===void 0?void 0:posts.length)&&isNextPostLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-sm mt-2\",children:\"Load more posts\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-center text-lg font-bold\",children:\"No posts yet.\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hidden xl:block\",children:[/*#__PURE__*/_jsx(SearchBar,{}),/*#__PURE__*/_jsx(SuggestedUsers,{})]})]});};export{Explore};","map":{"version":3,"names":["React","useEffect","useRef","Loader","PostCard","SearchBar","SideBar","SuggestedUsers","usePosts","actionTypes","sortPosts","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Explore","_usePosts","_usePosts$postsState","postsState","posts","page","isNextPostLoading","isLoading","postsDispatch","elementRef","SET_PAGE","SET_IS_NEXT_POST_LOADING","sortedPosts","slice","length","observer","IntersectionObserver","entries","entry","isIntersecting","type","payload","current","observe","document","title","timeoutId","setTimeout","clearTimeout","window","scrollTo","top","className","children","map","post","index","ref","_id"],"sources":["C:/Users/Tilwani's/Desktop/The-Dilemma/src/pages/Explore/Explore.jsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport {\n  Loader,\n  PostCard,\n  SearchBar,\n  SideBar,\n  SuggestedUsers,\n} from \"../../components\";\nimport { usePosts } from \"../../index\";\nimport { actionTypes } from \"../../utils/constants\";\nimport { sortPosts } from \"../../utils/sortPosts\";\n\nconst Explore = () => {\n  const {\n    postsState: { posts, page, isNextPostLoading },\n    isLoading,\n    postsDispatch,\n  } = usePosts();\n\n  const elementRef = useRef(null);\n\n  const { SET_PAGE, SET_IS_NEXT_POST_LOADING } = actionTypes;\n\n  const sortedPosts = sortPosts(posts, \"Latest\").slice(0, page * 5);\n\n  useEffect(() => {\n    if (sortedPosts.length > 0) {\n      const observer = new IntersectionObserver((entries) => {\n        const entry = entries[0];\n        if (entry.isIntersecting) {\n          postsDispatch({ type: SET_IS_NEXT_POST_LOADING, payload: true });\n          postsDispatch({ type: SET_PAGE, payload: page + 1 });\n        }\n      });\n      if (elementRef.current) {\n        observer.observe(elementRef.current);\n      }\n    }\n  }, [\n    page,\n    sortedPosts.length,\n    SET_IS_NEXT_POST_LOADING,\n    SET_PAGE,\n    postsDispatch,\n  ]);\n\n  document.title = \"Explore\";\n\n  useEffect(() => {\n    let timeoutId;\n    if (isNextPostLoading) {\n      timeoutId = setTimeout(() => {\n        postsDispatch({ type: SET_IS_NEXT_POST_LOADING, payload: false });\n      }, 1000);\n    }\n    return () => {\n      clearTimeout(timeoutId);\n    };\n  }, [isNextPostLoading, sortedPosts, SET_IS_NEXT_POST_LOADING, postsDispatch]);\n\n  useEffect(() => {\n    window.scrollTo({ top: 0 });\n    postsDispatch({ type: SET_PAGE, payload: 1 });\n  }, [postsDispatch, SET_PAGE]);\n\n  return (\n    <div className=\"grid sm:grid-cols-[5rem_1fr] lg:grid-cols-[12rem_1fr] xl:grid-cols-[13rem_1fr_20rem] w-[100%] lg:w-[80%] mb-16 sm:m-auto dark:bg-darkColor dark:text-lightGrey transition-all duration-500\">\n      <SideBar />\n\n      <div className=\"sm:border-x border-darkGrey dark:border-lightGrey\">\n        <h1 className=\" p-4 sticky top-0 backdrop-blur-md z-20 border-b border-darkGrey dark:border-lightGrey flex items-center justify-between gap-4\">\n          <span className=\"text-xl font-bold\">Explore</span>\n          <div className=\"block xl:hidden\">\n            <SearchBar />\n          </div>\n        </h1>\n\n        <div>\n          <div>\n            {isLoading ? (\n              <Loader />\n            ) : sortedPosts?.length > 0 ? (\n              <>\n                {sortedPosts.map((post, index) => {\n                  return (\n                    <React.Fragment key={post._id}>\n                      <PostCard post={post} />\n                      {index === sortedPosts?.length - 1 && (\n                        <div ref={elementRef} />\n                      )}\n                    </React.Fragment>\n                  );\n                })}\n                {!sortedPosts?.length === posts?.length &&\n                  isNextPostLoading && (\n                    <div className=\"text-center text-sm mt-2\">\n                      Load more posts\n                    </div>\n                  )}\n              </>\n            ) : (\n              <div className=\"p-4 text-center text-lg font-bold\">\n                No posts yet.\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"hidden xl:block\">\n        <SearchBar />\n        <SuggestedUsers />\n      </div>\n    </div>\n  );\n};\n\nexport { Explore };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}