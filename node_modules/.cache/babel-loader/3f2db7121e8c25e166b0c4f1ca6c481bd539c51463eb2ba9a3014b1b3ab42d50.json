{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Tilwani's/Desktop/The-Dilemma/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Tilwani's/Desktop/The-Dilemma/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Tilwani's/Desktop/The-Dilemma/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import data from\"@emoji-mart/data\";import Picker from\"@emoji-mart/react\";import{Modal}from\"@mui/material\";import{useRef,useState}from\"react\";import{toast}from\"react-hot-toast\";import{PrimaryButton,UserAvatar}from\"..\";import{useAuth,usePosts,useTheme}from\"../../index\";import{styles}from\"../../utils/constants\";import{MdCancel,MdInsertEmoticon,MdOutlineAddPhotoAlternate}from\"../../utils/icons\";import{uploadMedia}from\"../../utils/uploadMedia\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NewPost=function NewPost(){var _media$type;var _useTheme=useTheme(),isDarkTheme=_useTheme.isDarkTheme;var _useAuth=useAuth(),currentUser=_useAuth.currentUser;var _usePosts=usePosts(),createPostHandler=_usePosts.createPostHandler;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showEmojiPicker=_useState2[0],setShowEmojiPicker=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),content=_useState4[0],setContent=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),media=_useState6[0],setMedia=_useState6[1];var newPostRef=useRef();var submitPostHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var toastId,resp;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();toastId=toast.loading(\"Creating new post..\");if(!media){_context.next=9;break;}_context.next=5;return uploadMedia(media);case 5:resp=_context.sent;createPostHandler({content:content,media:resp.url,mediaAlt:resp.original_filename});_context.next=10;break;case 9:createPostHandler({content:content,media:\"\",mediaAlt:\"\"});case 10:toast.success(\"Added new post successfully\",{id:toastId});setContent(\"\");setMedia(null);setShowEmojiPicker(false);newPostRef.current.innerText=\"\";case 15:case\"end\":return _context.stop();}},_callee);}));return function submitPostHandler(_x){return _ref.apply(this,arguments);};}();console.log(media);return/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-[2.25rem_1fr] gap-2 items-start text-sm border-b border-darkGrey px-4 py-3 cursor-text dark:border-lightGrey\",children:[/*#__PURE__*/_jsx(UserAvatar,{user:currentUser,className:\"h-9 w-9\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"flex flex-col gap-2\",onSubmit:submitPostHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full outline-none mt-1.5 h-auto\",children:[/*#__PURE__*/_jsx(\"textarea\",{ref:newPostRef,value:content,rows:2,className:\"w-full dark:bg-darkColor outline-none resize-none h-auto\",placeholder:\"What is happening?!\",onChange:function onChange(e){return setContent(e.target.value);}}),media?/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[media!==null&&media!==void 0&&(_media$type=media.type)!==null&&_media$type!==void 0&&_media$type.includes(\"video\")?/*#__PURE__*/_jsx(\"video\",{controls:true,className:\"w-full h-auto rounded-md\",children:/*#__PURE__*/_jsx(\"source\",{src:URL.createObjectURL(media),type:\"video/mp4\"})}):/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(media),alt:\"demo\",className:\"w-full h-auto rounded-md\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"absolute top-1.5 left-2 text-lg\",onClick:function onClick(){return setMedia(null);},children:/*#__PURE__*/_jsx(MdCancel,{})})]}):/*#__PURE__*/_jsx(_Fragment,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex items-center gap-4 mt-1.5\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*, video/*\",className:\"hidden\",onChange:function onChange(e){return setMedia(e.target.files[0]);}}),/*#__PURE__*/_jsx(MdOutlineAddPhotoAlternate,{className:\"text-xl scale-110 hover:scale-125\",title:\"Add Photo/GIF/Video\"})]}),/*#__PURE__*/_jsx(\"label\",{className:\"cursor-pointer\",onClick:function onClick(){return setShowEmojiPicker(function(prev){return!prev;});},children:/*#__PURE__*/_jsx(MdInsertEmoticon,{className:\"text-xl scale-110 hover:scale-125\",title:\"Add Emoji\"})}),/*#__PURE__*/_jsx(PrimaryButton,{type:\"submit\",className:\"py-1 px-4 rounded-md disabled:opacity-80 disabled:cursor-not-allowed\",disabled:!content.trim()&&!media,children:\"Post\"})]})]}),/*#__PURE__*/_jsx(Modal,{open:showEmojiPicker,onClose:function onClose(){return setShowEmojiPicker(false);},children:/*#__PURE__*/_jsx(\"div\",{style:styles,children:/*#__PURE__*/_jsx(Picker,{data:data,emojiSize:20,emojiButtonSize:28,maxFrequentRows:0,navPosition:\"bottom\",previewPosition:\"none\",theme:isDarkTheme?\"dark\":\"light\",onEmojiSelect:function onEmojiSelect(emoji){setContent(content+emoji.native);setShowEmojiPicker(false);}})})})]});};export{NewPost};","map":{"version":3,"names":["data","Picker","Modal","useRef","useState","toast","PrimaryButton","UserAvatar","useAuth","usePosts","useTheme","styles","MdCancel","MdInsertEmoticon","MdOutlineAddPhotoAlternate","uploadMedia","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NewPost","_media$type","_useTheme","isDarkTheme","_useAuth","currentUser","_usePosts","createPostHandler","_useState","_useState2","_slicedToArray","showEmojiPicker","setShowEmojiPicker","_useState3","_useState4","content","setContent","_useState5","_useState6","media","setMedia","newPostRef","submitPostHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","toastId","resp","wrap","_callee$","_context","prev","next","preventDefault","loading","sent","url","mediaAlt","original_filename","success","id","current","innerText","stop","_x","apply","arguments","console","log","className","children","user","onSubmit","ref","value","rows","placeholder","onChange","e","target","type","includes","controls","src","URL","createObjectURL","alt","onClick","accept","files","title","disabled","trim","open","onClose","style","emojiSize","emojiButtonSize","maxFrequentRows","navPosition","previewPosition","theme","onEmojiSelect","emoji","native"],"sources":["C:/Users/Tilwani's/Desktop/The-Dilemma/src/components/NewPost/NewPost.jsx"],"sourcesContent":["import data from \"@emoji-mart/data\";\nimport Picker from \"@emoji-mart/react\";\nimport { Modal } from \"@mui/material\";\nimport { useRef, useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { PrimaryButton, UserAvatar } from \"..\";\nimport { useAuth, usePosts, useTheme } from \"../../index\";\nimport { styles } from \"../../utils/constants\";\nimport {\n  MdCancel,\n  MdInsertEmoticon,\n  MdOutlineAddPhotoAlternate,\n} from \"../../utils/icons\";\nimport { uploadMedia } from \"../../utils/uploadMedia\";\n\nconst NewPost = () => {\n  const { isDarkTheme } = useTheme();\n  const { currentUser } = useAuth();\n  const { createPostHandler } = usePosts();\n\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\n  const [content, setContent] = useState(\"\");\n  const [media, setMedia] = useState(null);\n\n  const newPostRef = useRef();\n\n  const submitPostHandler = async (event) => {\n    event.preventDefault();\n    const toastId = toast.loading(\"Creating new post..\");\n    if (media) {\n      const resp = await uploadMedia(media);\n      createPostHandler({\n        content,\n        media: resp.url,\n        mediaAlt: resp.original_filename,\n      });\n    } else {\n      createPostHandler({ content, media: \"\", mediaAlt: \"\" });\n    }\n    toast.success(\"Added new post successfully\", { id: toastId });\n    setContent(\"\");\n    setMedia(null);\n    setShowEmojiPicker(false);\n    newPostRef.current.innerText = \"\";\n  };\n\n  console.log(media);\n\n  return (\n    <div className=\"grid grid-cols-[2.25rem_1fr] gap-2 items-start text-sm border-b border-darkGrey px-4 py-3 cursor-text dark:border-lightGrey\">\n      <UserAvatar user={currentUser} className=\"h-9 w-9\" />\n      <form className=\"flex flex-col gap-2\" onSubmit={submitPostHandler}>\n        <div className=\"w-full outline-none mt-1.5 h-auto\">\n          <textarea\n            ref={newPostRef}\n            value={content}\n            rows={2}\n            className=\"w-full dark:bg-darkColor outline-none resize-none h-auto\"\n            placeholder=\"What is happening?!\"\n            onChange={(e) => setContent(e.target.value)}\n          ></textarea>\n          {media ? (\n            <div className=\"relative\">\n              {media?.type?.includes(\"video\") ? (\n                <video controls className=\"w-full h-auto rounded-md\">\n                  <source src={URL.createObjectURL(media)} type=\"video/mp4\" />\n                </video>\n              ) : (\n                <img\n                  src={URL.createObjectURL(media)}\n                  alt=\"demo\"\n                  className=\"w-full h-auto rounded-md\"\n                />\n              )}\n\n              <button\n                type=\"button\"\n                className=\"absolute top-1.5 left-2 text-lg\"\n                onClick={() => setMedia(null)}\n              >\n                <MdCancel />\n              </button>\n            </div>\n          ) : (\n            <></>\n          )}\n        </div>\n\n        <div className=\"ml-auto flex items-center gap-4 mt-1.5\">\n          <label className=\"cursor-pointer\">\n            <input\n              type=\"file\"\n              accept=\"image/*, video/*\"\n              className=\"hidden\"\n              onChange={(e) => setMedia(e.target.files[0])}\n            />\n            <MdOutlineAddPhotoAlternate\n              className=\"text-xl scale-110 hover:scale-125\"\n              title=\"Add Photo/GIF/Video\"\n            />\n          </label>\n          <label\n            className=\"cursor-pointer\"\n            onClick={() => setShowEmojiPicker((prev) => !prev)}\n          >\n            <MdInsertEmoticon\n              className=\"text-xl scale-110 hover:scale-125\"\n              title=\"Add Emoji\"\n            />\n          </label>\n          <PrimaryButton\n            type=\"submit\"\n            className=\"py-1 px-4 rounded-md disabled:opacity-80 disabled:cursor-not-allowed\"\n            disabled={!content.trim() && !media}\n          >\n            Post\n          </PrimaryButton>\n        </div>\n      </form>\n\n      <Modal open={showEmojiPicker} onClose={() => setShowEmojiPicker(false)}>\n        <div style={styles}>\n          <Picker\n            data={data}\n            emojiSize={20}\n            emojiButtonSize={28}\n            maxFrequentRows={0}\n            navPosition=\"bottom\"\n            previewPosition=\"none\"\n            theme={isDarkTheme ? \"dark\" : \"light\"}\n            onEmojiSelect={(emoji) => {\n              setContent(content + emoji.native);\n              setShowEmojiPicker(false);\n            }}\n          />\n        </div>\n      </Modal>\n    </div>\n  );\n};\n\nexport { NewPost };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}